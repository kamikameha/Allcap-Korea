"use strict";function Rotation(t){return this instanceof Rotation?("string"==typeof t&&(t=document.querySelector(t)),this.el=t,this.current=0,this.cycle(!0),this.interval(75),this.start(0),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onWheel=this.onWheel.bind(this),void this.bind()):new Rotation(t)}var Emitter=require("component-emitter"),wheel=require("eventwheel");module.exports=Rotation,Emitter(Rotation.prototype),Rotation.prototype.scroll=function(t){return this._scroll===t?this:(this._scroll=t,this._scroll?wheel.bind(this.el,this.onWheel):wheel.unbind(this.el,this.onWheel),this)},Rotation.prototype.vertical=function(t){return this._vertical=t,this},Rotation.prototype.reverse=function(t){return this._reverse=t,this},Rotation.prototype.cycle=function(t){return this._cycle=t,this},Rotation.prototype.interval=function(t){return this._interval=t,this},Rotation.prototype.start=function(t){var e=this.children();this.el.style.position="relative",this.el.style.width="100%";for(var o=0,i=e.length;i>o;o++)e[o].style.display="none",e[o].style.width="100%";return this.show(t),this},Rotation.prototype.play=function(t){function e(){(void 0===t||t>o.current)&&o.next(),t<o.current&&o.prev(),t===o.current&&o.stop()}if(!this.timer){var o=this;return this.timer=setInterval(e,this._interval),this}},Rotation.prototype.stop=function(){return clearInterval(this.timer),this.timer=null,this},Rotation.prototype.prev=function(){return this.show(this.current-1)},Rotation.prototype.next=function(){return this.show(this.current+1)},Rotation.prototype.show=function(t){var e=this.children(),o=e.length;return 0>t&&(t=this._cycle?t+o:0),t>o-1&&(t=this._cycle?t-o:o-1),e[this.current].style.display="none",e[t].style.display="block",t!==this.current&&this.emit("show",t,o),this.current=t,this},Rotation.prototype.bind=function(){this.el.addEventListener("touchstart",this.onTouchStart,!1),this.el.addEventListener("touchmove",this.onTouchMove,!1),this.el.addEventListener("touchend",this.onTouchEnd,!1),this.el.addEventListener("mousedown",this.onTouchStart,!1),this.el.addEventListener("mousemove",this.onTouchMove,!1),document.addEventListener("mouseup",this.onTouchEnd,!1),this._scroll&&wheel.bind(this.el,this.onWheel)},Rotation.prototype.unbind=function(){this.el.removeEventListener("touchstart",this.onTouchStart,!1),this.el.removeEventListener("touchmove",this.onTouchMove,!1),this.el.removeEventListener("touchend",this.onTouchEnd,!1),this.el.removeEventListener("mousedown",this.onTouchStart,!1),this.el.removeEventListener("mousemove",this.onTouchMove,!1),document.removeEventListener("mouseup",this.onTouchEnd,!1),this._scroll&&wheel.unbind(this.el,this.onWheel)},Rotation.prototype.onTouchStart=function(t){this.timer&&this.stop(),t.preventDefault(),this.touch=this.getTouch(t),this.currentTouched=this.current},Rotation.prototype.onTouchMove=function(t){if("number"==typeof this.touch){t.preventDefault();var e=this.getTouch(t),o=this.children().length,i=this.el[this._vertical?"clientHeight":"clientWidth"],n=e-this.touch;n=this._reverse?-n:n,n=Math.floor(n/i*o),this.show(this.currentTouched+n)}},Rotation.prototype.onTouchEnd=function(t){"number"==typeof this.touch&&(t.preventDefault(),this.touch=null)},Rotation.prototype.onWheel=function(t){this.timer&&this.stop(),t.preventDefault();var e=t.deltaY||t.detail||-t.wheelDelta;e=0!==e?e/Math.abs(e):e,e=this._reverse?-e:e,this[e>0?"next":"prev"]()},Rotation.prototype.children=function(){for(var t=this.el.childNodes,e=[],o=0,i=t.length;i>o;o++)1===t[o].nodeType&&e.push(t[o]);return e},Rotation.prototype.getTouch=function(t){return t=/^touch/.test(t.type)?t.changedTouches[0]:t,this._vertical?t.clientY-this.el.offsetTop:t.clientX-this.el.offsetLeft};